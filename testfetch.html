<html>
        <div id="inputContainer" style="display: none;">
            <label for="fileInput">Load Bocce Team Schedule:</label>
			<input type="file" id="fileInput">
        </div>

<div id="fileStatus"></div>

<script>
attempts = [];

const fileInput = document.getElementById('fileInput');
const fileStatus = document.getElementById('fileStatus');

async function checkFileExists(filename) {
  try {
    const response = await fetch(`https://kmcurley.github.io/workspace/${encodeURIComponent(filename)}`);
    const result = await response.json();
	console.log(`result.exists=${result.exists}`);
    if (result.exists) {
      fileInput.disabled = true;
      fileStatus.textContent = `Using server-side file: ${filename}`;
      // Optionally trigger logic to load/process that file
    } else {
      fileInput.disabled = false;
      fileStatus.textContent = 'Please upload a file.';
	  document.getElementById('scheduleContainer').style.display = 'flex';
    }
  } catch (err) {
    console.error('Error checking file:', err);
    fileStatus.textContent = 'Error checking file status.';
    fileInput.disabled = false;
  }
}

// ----------------- Loading CSV -----------------
function tryAutoLoadFile(csvFile){
  attempts.push(csvFile); // maybe includes .csv

  // attempt fetch sequentially until one ok
  (async function trySequential(idx=0){
    if(idx >= attempts.length){
      // no success; leave UI able to paste or select file
      inputContainer.disabled = false;
      fileStatus.textContent = 'Please upload a file.';
      return;
    }
    const url = attempts[idx];
	console.log(`url(${url})`);
    try {
      const res = await fetch(url);
      if(!res.ok) throw new Error('fetch failed ' + res.status);
      const text = await res.text();
	  inputContainer.disabled = true;
      fileStatus.textContent = `Using server-side file: ${csvFile}`;
      console.log(text);
	  //processCsvText(text);
      return;
    } catch(e){
      // try next
      trySequential(idx+1);
    }
  })();
}
console.log("Calling checkFileExists...");
//checkFileExists('schedule.csv'); // Replace with dynamic filename if needed
tryAutoLoadFile('bocce-schedule-2025.csv');
</script>
</html>