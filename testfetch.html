<html>
<input type="file" id="fileInput">
<div id="fileStatus"></div>

<script>
const fileInput = document.getElementById('fileInput');
const fileStatus = document.getElementById('fileStatus');

async function checkFileExists(filename) {
  try {
    console.log(`filename=${filename}   encode=${encodeURIComponent(filename)}`);
    const response = await fetch(`https://kmcurley.github.io/workspace/${encodeURIComponent(filename)}`);
	//const response = await fetch(`https://kmcurley.github.io/workspace/csv-list.json`);
    const result = await response.json();
	console.log(`result.exists=${result.exists}`);
    if (result.exists) {
      fileInput.disabled = true;
      fileStatus.textContent = `Using server-side file: ${filename}`;
      // Optionally trigger logic to load/process that file
    } else {
      fileInput.disabled = false;
      fileStatus.textContent = 'Please upload a file.';
    }
  } catch (err) {
    console.error('Error checking file:', err);
    fileStatus.textContent = 'Error checking file status.';
    fileInput.disabled = false;
  }
}

// ----------------- Loading CSV -----------------
function tryAutoLoadFile(csvFile){
  attempts.push(csvFile); // maybe includes .csv

  // attempt fetch sequentially until one ok
  (async function trySequential(idx=0){
    if(idx >= attempts.length){
      // no success; leave UI able to paste or select file
      qs('#csv-loaded').textContent = 'none';
      return;
    }
    const url = attempts[idx];
	console.log(`url(${url})`);
    try {
      const res = await fetch(url);
      if(!res.ok) throw new Error('fetch failed ' + res.status);
      const text = await res.text();
      state.csvUrl = url;
      state.rawText = text;
      //processCsvText(text, url);
      return;
    } catch(e){
      // try next
      trySequential(idx+1);
    }
  })();
}
console.log("Calling checkFileExists...");
checkFileExists('bocce-schedule-2025.csv'); // Replace with dynamic filename if needed
</script>

</html>

